<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>ðŸ“¦ Estoque Headset</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#6c4df5">
  <style>
    body{font-family:Arial,sans-serif;margin:0;padding:0;background:#f8f9ff}
    header{padding:1rem;text-align:center;background:#6c4df5;color:#fff}
    .card{background:#fff;margin:1rem;padding:1rem;border-radius:10px;box-shadow:0 2px 6px #ccc}
    .name{font-size:1.3rem;font-weight:bold}
    .code{font-size:.9rem;color:#555}
    .badge{padding:.4rem .8rem;border-radius:20px;font-size:.9rem}
    .b-ok{background:#dff5ec}
    .b-warn{background:#fff5d4}
    .b-danger{background:#ffd6d6}
  </style>
</head>
<body>
  <header>
    <h1>ðŸ“¦ Estoque de Materiais Headset</h1>
  </header>
  <main id="produtos">Carregando...</main>

  <script>
    const API = "https://script.google.com/macros/s/AKfycbwKsk6mfZ2UHYfRY--rhyioYaTYUMoxp6kK1flekZjLAVMCgwU7z_f5MkzKSsXEHm7NCQ/exec";

    function classByLevel(e,m){
      if(m>0){
        if(e <= 0.25*m) return "b-danger";
        if(e < m) return "b-warn";
      }
      return "b-ok";
    }

    fetch(API+"?act=listar")
      .then(r=>r.json())
      .then(data=>{
        document.getElementById("produtos").innerHTML = data.map(it=>`
          <div class="card">
            <div class="name">${it.nome}</div>
            <div class="code">CÃ³d: ${it.codigo}</div>
            <div class="badge ${classByLevel(it.estoque,it.minimo)}">
              Estoque: ${it.estoque}
            </div>
          </div>
        `).join("");
      })
      .catch(err=>{
        document.getElementById("produtos").innerHTML = "Erro: "+err;
      });
  </script>
</body>
</html>
