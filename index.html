<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Estoque Headset</title>
  <meta name="theme-color" content="#6c4df5" />
  <link rel="manifest" href="./manifest.json" />
  <link rel="icon" href="./icon-192.png" />
  <style>
    :root{ --ink:#14162b; --muted:#7b86bc; --violet:#6c4df5; }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto;
      background:#f6f4ff; color:var(--ink);
      display:flex; align-items:center; justify-content:center; padding:24px;
    }
    .card{
      width:min(880px,100%); background:#fff; border-radius:24px;
      padding:32px 36px; box-shadow:0 40px 120px rgba(108,77,245,.18);
    }
    .title{display:flex; gap:16px; align-items:center; margin:0 0 8px}
    .title img{width:44px;height:44px;border-radius:50%}
    h1{font-size:42px; line-height:1.1; margin:0}
    p{margin:0; color:var(--muted); font-weight:600}
    .cta{display:flex; gap:16px; margin-top:28px; align-items:center}
    .btn{
      appearance:none; border:0; border-radius:14px; padding:16px 26px;
      background:#6c4df5; color:#fff; font-size:18px; font-weight:800; cursor:pointer;
      box-shadow:0 20px 40px rgba(108,77,245,.25);
    }
    .link{font-size:20px; font-weight:800; color:#5a54d9; text-decoration:none}
    .hint{margin-top:18px; color:#9aa3d4; font-weight:700}
  </style>
</head>
<body>
  <main class="card">
    <div class="title">
      <img src="./icon-192.png" alt="logo">
      <h1>Estoque Headset</h1>
    </div>
    <p>Abrindo o aplicativo‚Ä¶</p>
    <div class="cta">
      <button id="open" class="btn">Abrir agora</button>
      <a id="openNew" class="link" href="#" rel="noopener">abrir em nova aba</a>
    </div>
    <p class="hint">Se o redirecionamento autom√°tico n√£o acontecer, toque em <b>Abrir agora</b>.</p>
  </main>

  <script>
    // üîó URL do seu Apps Script (NOVA)
    const APP_URL = "https://script.google.com/macros/s/AKfycbx4BguCm3hnMO90-Z5qCT7Ha4X6Woesbolxkoe-oIxUfQ2_zPxfcSQCWX9zj7lKGHqD1w/exec";

    // iOS/Safari costuma bloquear auto-redirect. Fazemos um open com usu√°rio-gesture.
    const btn = document.getElementById('open');
    const link = document.getElementById('openNew');

    function openApp(sameTab=true){
      try{
        if (sameTab) location.href = APP_URL;
        else window.open(APP_URL, '_blank', 'noopener');
      }catch(e){ location.href = APP_URL; }
    }

    btn.addEventListener('click', () => openApp(true));
    link.addEventListener('click', (e) => { e.preventDefault(); openApp(false); });

    // Tentativa discreta ap√≥s 800ms (Android costuma aceitar)
    setTimeout(()=>openApp(true), 800);

    // registra SW (cache offline s√≥ do shell; API passa direto)
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('./service-worker.js').catch(()=>{});
    }
  </script>
</body>
</html>
